#!/usr/local/bin/koios
#   koios-polos (axis of heaven) unit testing meta-language



#23456789-12  123456789-123456789-123456789-12345  123456789-123456789-123456  123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-  123456789-  123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-  123456789-123456789- 
#==(verb)===  ===========(description)===========  =====(function)===========  ========================(arguments)=================================================================  ==(test)==  ==========================(results)=================================================================  ========(var)======= 
PREP          include the prototype headers                                      - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   - - - - -   - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
   incl       include public header                metis.h                     - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   - - - - -   - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  



#23456789-12  123456789-123456789-123456789-12345  123456789-123456789-123456  123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-  123456789-  123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-  123456789-123456789- 
#==(verb)===  ===========(description)===========  =====(function)===========  ========================(arguments)=================================================================  ==(test)==  ==========================(results)=================================================================  ========(var)======= 
SHARED   -a-  create central testing directory                                                                                                                                         ((01.---))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  

   COND       make the directory                                                 - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((02.002))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     call create                          yURG_mkdir                  "/tmp/lib"                        , "root"      , "root"       , "0600"                               i_equal     0                                                                                                    
     exec     call create                          yURG_mkdir                  "/tmp/lib/metis"                  , "root"      , "root"       , "0600"                               i_equal     0                                                                                                    



#23456789-12  123456789-123456789-123456789-12345  123456789-123456789-123456  123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-  123456789-  123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-  123456789-123456789- 
#==(verb)===  ===========(description)===========  =====(function)===========  ========================(arguments)=================================================================  ==(test)==  ==========================(results)=================================================================  ========(var)======= 
SHARED   -b-  remove central testing directory                                                                                                                                         ((01.---))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  

   COND       remove the directory                                               - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((02.002))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     call create                          yURG_rmdir                  "/tmp/lib/metis"                                                                                      i_equal     0                                                                                                    
     exec     call create                          yURG_rmdir                  "/tmp/lib"                                                                                            i_equal     0                                                                                                    



#23456789-12  123456789-123456789-123456789-12345  123456789-123456789-123456  123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-  123456789-  123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-  123456789-123456789- 
#==(verb)===  ===========(description)===========  =====(function)===========  ========================(arguments)=================================================================  ==(test)==  ==========================(results)=================================================================  ========(var)======= 
SCRP          (DB) verify changing database name (and on command line)           0s   cli             metis_db_cli                                                                 ((01.---))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  

   COND       verify program setup                                               - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((01.001))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     setup the program                    PROG__unit_quiet                                                                                                                  i_equal     0                                                                                                    
     local    create working variable              - - - - - - - - - - - - -   char       *x_argA [3]  = { "metis_unit"   , "--database", "ruby"       };                                                                                                                                                 
     local    create working variable              - - - - - - - - - - - - -   char       *x_argB [2]  = { "metis_unit"   , "--normal"  };                                                                                                                                                                
     local    create working variable              - - - - - - - - - - - - -   char       *x_argC [4]  = { "metis_unit"   , "--normal"  , "--database", "trudy"      };                                                                                                                                   
     local    create working variable              - - - - - - - - - - - - -   char       *x_argD [4]  = { "metis_unit"   , "--normal"  , "--database", "andy"                  };                                                                                                                        
     local    create working variable              - - - - - - - - - - - - -   char       *x_argE [3]  = { "metis_unit"   , "--normal"  , "--database" };                                                                                                                                                 
     local    create working variable              - - - - - - - - - - - - -   char       *x_argF [3]  = { "metis_unit"   , "--normal"  , "--database"               };                                                                                                                                   

   COND       turn off screen output                                             - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((01.002))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     call yURG error file to bitbucket    yURG_err_none                                                                                                                     i_equal     0                                                                                                    

   COND       quick, obvious success                                             - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((01.003))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     ... call name change                 metis_db_cli                "testing.db"                           , 'y'                                                          i_equal     0                                                                                                    
     get      ... review name                      metis_db__unit              "file"                                                                                                s_equal     DB file          : -  ¬¬¬¬¬¬¬¬¬¬  -  10åtesting.dbæ                                                  

   COND       attempt with a null                                                - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((01.004))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     ... call name change                 metis_db_cli                NULL                                   , 'y'                                                          i_lesser    0                                                                                                    
     get      ... review name                      metis_db__unit              "file"                                                                                                s_equal     DB file          : -  ¬¬¬¬¬¬¬¬¬¬  -  10åtesting.dbæ                                                  
     get      ... get the last error               yURG_err_last                                                                                                                     s_equal     database <name>, name can not be null                                                                

   COND       verify with fully qualified path                                   - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((01.005))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     ... call name change                 metis_db_cli                "/home/member/poly.db"                 , 'y'                                                          i_equal     0                                                                                                    
     get      ... review name                      metis_db__unit              "file"                                                                                                s_equal     DB file          : -  ¬¬¬¬¬¬¬¬¬¬  -  20å/home/member/poly.dbæ                                        

   COND       attempt with an empty                                              - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((01.006))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     ... call name change                 metis_db_cli                ""                                     , 'y'                                                          i_lesser    0                                                                                                    
     get      ... review name                      metis_db__unit              "file"                                                                                                s_equal     DB file          : -  ¬¬¬¬¬¬¬¬¬¬  -  20å/home/member/poly.dbæ                                        
     get      ... get the last error               yURG_err_last                                                                                                                     s_equal     database <name>, name can not be blank/empty                                                         

   COND       verify auto-appending suffix                                       - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((01.007))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     ... call name change                 metis_db_cli                "poly"                                 , 'y'                                                          i_equal     0                                                                                                    
     get      ... review name                      metis_db__unit              "file"                                                                                                s_equal     DB file          : -  ¬¬¬¬¬¬¬¬¬¬  -   7åpoly.dbæ                                                     

   COND       verify auto-appending suffix (second suffix)                       - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((01.008))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     ... call name change                 metis_db_cli                "poly.dat"                             , 'y'                                                          i_equal     0                                                                                                    
     get      ... review name                      metis_db__unit              "file"                                                                                                s_equal     DB file          : -  ¬¬¬¬¬¬¬¬¬¬  -  11åpoly.dat.dbæ                                                 

   COND       attempt with bad characters                                        - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((01.009))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     ... call name change                 metis_db_cli                "poly-dat"                             , 'y'                                                          i_lesser    0                                                                                                    
     get      ... get the last error               yURG_err_last                                                                                                                     s_equal     database <name>, name can not have a <-> at character 4                                              
     exec     ... call name change                 metis_db_cli                "poly.dat:"                            , 'y'                                                          i_lesser    0                                                                                                    
     get      ... get the last error               yURG_err_last                                                                                                                     s_equal     database <name>, name can not have a <:> at character 8                                              
     exec     ... call name change                 metis_db_cli                " poly.dat"                            , 'y'                                                          i_lesser    0                                                                                                    
     get      ... get the last error               yURG_err_last                                                                                                                     s_equal     database <name>, name can not have a < > at character 0                                              

   COND       verify args processing                                             - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((01.010))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     reset yJOBS                          PROG_reset_yjobs                                                                                                                  i_equal     0                                                                                                    
     exec     ... call args                        PROG__args                  3              , x_argA                                                                               i_equal     0                                                                                                    
     get      ... review name                      metis_db__unit              "file"                                                                                                s_equal     DB file          : -  ¬¬¬¬¬¬¬¬¬¬  -   7åruby.dbæ                                                     

   COND       verify args processing, no database arg                            - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((01.011))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     reset yJOBS                          PROG_reset_yjobs                                                                                                                  i_equal     0                                                                                                    
     exec     ... call args                        PROG__args                  2              , x_argB                                                                               i_equal     0                                                                                                    
     get      ... review name                      metis_db__unit              "file"                                                                                                s_equal     DB file          : -  ¬¬¬¬¬¬¬¬¬¬  -   7åruby.dbæ                                                     

   COND       verify args processing, more args                                  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((01.012))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     reset yJOBS                          PROG_reset_yjobs                                                                                                                  i_equal     0                                                                                                    
     exec     ... call args                        PROG__args                  4              , x_argC                                                                               i_equal     0                                                                                                    
     get      ... review name                      metis_db__unit              "file"                                                                                                s_equal     DB file          : -  ¬¬¬¬¬¬¬¬¬¬  -   8åtrudy.dbæ                                                    

   COND       verify args processing, args before and after                      - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((01.013))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     reset yJOBS                          PROG_reset_yjobs                                                                                                                  i_equal     0                                                                                                    
     exec     ... call args                        PROG__args                  4              , x_argD                                                                               i_equal     0                                                                                                    
     get      ... review name                      metis_db__unit              "file"                                                                                                s_equal     DB file          : -  ¬¬¬¬¬¬¬¬¬¬  -   7åandy.dbæ                                                     

   COND       verify args processing, no arg                                     - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((01.014))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     reset yJOBS                          PROG_reset_yjobs                                                                                                                  i_equal     0                                                                                                    
     exec     ... call args                        PROG__args                  3              , x_argE                                                                               i_lesser    0                                                                                                    
     get      ... review name                      metis_db__unit              "file"                                                                                                s_equal     DB file          : -  ¬¬¬¬¬¬¬¬¬¬  -   7åandy.dbæ                                                     

   COND       verify args processing, no arg not content                         - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((01.015))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     reset yJOBS                          PROG_reset_yjobs                                                                                                                  i_equal     0                                                                                                    
     exec     ... call args                        PROG__args                  3              , x_argF                                                                               i_lesser    0                                                                                                    
     get      ... review name                      metis_db__unit              "file"                                                                                                s_equal     DB file          : -  ¬¬¬¬¬¬¬¬¬¬  -   7åandy.dbæ                                                     

   COND       complete testing                                                   - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((01.016))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     stop testing                         PROG__unit_end                                                                                                                    i_equal     0                                                                                                    



#23456789-12  123456789-123456789-123456789-12345  123456789-123456789-123456  123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-  123456789-  123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-  123456789-123456789- 
#==(verb)===  ===========(description)===========  =====(function)===========  ========================(arguments)=================================================================  ==(test)==  ==========================(results)=================================================================  ========(var)======= 
SCRP          (DB) verify reading and writing database header                    1s   header          metis_db_write, metis_db_read                                                ((02.---))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  

   COND       verify program setup                                               - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((02.001))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     setup the program                    PROG__unit_quiet                                                                                                                  i_equal     0                                                                                                    
     local    create working variable              - - - - - - - - - - - - -   ushort    x_nmajor  =  0;                                                                                                                                                                                                  
     local    create working variable              - - - - - - - - - - - - -   ushort    x_nminor  =  0;                                                                                                                                                                                                  
     local    create working variable              - - - - - - - - - - - - -   ushort    x_nsource =  0;                                                                                                                                                                                                  
     local    create working variable              - - - - - - - - - - - - -   ushort    x_ntask   =  0;                                                                                                                                                                                                  
     local    create working variable              - - - - - - - - - - - - -   char      x_name    [LEN_DESC]  = "/tmp/lib/metis/metis.db";                                                                                                                                                               
     local    create working variable              - - - - - - - - - - - - -   char      x_heart   [LEN_DESC]  = "";                                                                                                                                                                                      

   REUSE -a-  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   - - - - -   - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  

   COND       prepare statistics                                                 - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((02.004))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     code     update heartbeat                     - - - - - - - - - - - - -   yEXEC_heartbeat (12345, 1494680400, NULL, NULL, x_heart);                                                                                                                                                                  
     echo     ... review heartbeat                 - - - - - - - - - - - - -   x_heart                                                                                               w_equal     å17.05.13.06.00.00.6.19.133  1494680400   ¬¬¬¬¬æ                                                     
     code     ... prepare stats                    - - - - - - - - - - - - -   x_nmajor  = 3;   x_nminor  = 15; x_nsource = 5; x_ntask   = 150;                                                                                                                                                            

   COND       attempt with missing pointers                                      - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((03.006))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     call database write                  metis_db__open              NULL           , 'w'       , &x_nmajor , &x_nminor , &x_nsource, &x_ntask  , x_heart   , &(my.f_db)   i_lesser    0                                                                                                    
     exec     call database write                  metis_db__open              x_name         , 'w'       , NULL      , &x_nminor , &x_nsource, &x_ntask  , x_heart   , &(my.f_db)   i_lesser    0                                                                                                    
     exec     call database write                  metis_db__open              x_name         , 'w'       , &x_nmajor , NULL      , &x_nsource, &x_ntask  , x_heart   , &(my.f_db)   i_lesser    0                                                                                                    
     exec     call database write                  metis_db__open              x_name         , 'w'       , &x_nmajor , &x_nminor , NULL      , &x_ntask  , x_heart   , &(my.f_db)   i_lesser    0                                                                                                    
     exec     call database write                  metis_db__open              x_name         , 'w'       , &x_nmajor , &x_nminor , &x_nsource, NULL      , x_heart   , &(my.f_db)   i_lesser    0                                                                                                    
     exec     call database write                  metis_db__open              x_name         , 'w'       , &x_nmajor , &x_nminor , &x_nsource, &x_ntask  , NULL      , &(my.f_db)   i_lesser    0                                                                                                    
     exec     call database write                  metis_db__open              x_name         , 'w'       , &x_nmajor , &x_nminor , &x_nsource, &x_ntask  , x_heart   , NULL         i_lesser    0                                                                                                    

   COND       verify open and write header                                       - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((03.006))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     call database write                  metis_db__open              x_name         , 'w'       , &x_nmajor , &x_nminor , &x_nsource, &x_ntask  , x_heart   , &(my.f_db)   i_equal     0                                                                                                    
     echo     ... review file                      - - - - - - - - - - - - -   my.f_db                                                                                               p_exists    0                                                                                                    

   COND       attempt to re-open                                                 - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((03.006))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     call database write                  metis_db__open              x_name         , 'w'       , &x_nmajor , &x_nminor , &x_nsource, &x_ntask  , x_heart   , &(my.f_db)   i_lesser    0                                                                                                    

   COND       attempt close with missing pointer                                 - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((03.006))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     call database close                  metis_db__close             NULL                                                                                                  i_lesser    0                                                                                                    

   COND       verify closing database                                            - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((03.006))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     call database close                  metis_db__close             &(my.f_db)                                                                                            i_equal     0                                                                                                    
     echo     ... review file                      - - - - - - - - - - - - -   my.f_db                                                                                               p_null      0                                                                                                    

   COND       attempt to re-close                                                - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((03.006))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     call database close                  metis_db__close             &(my.f_db)                                                                                            i_lesser    0                                                                                                    

   COND       clear statistics                                                   - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((03.007))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     code     ... clear heartbeat                  - - - - - - - - - - - - -   strcpy (x_heart, "");                                                                                                                                                                                                      
     code     ... prepare stats                    - - - - - - - - - - - - -   x_nmajor  = 0;   x_nminor  =  0; x_nsource = 0; x_ntask   =   0;                                                                                                                                                            
     echo     ... review project count             - - - - - - - - - - - - -   x_nmajor                                                                                              i_equal     0                                                                                                    
     echo     ... review file count                - - - - - - - - - - - - -   x_nminor                                                                                              i_equal     0                                                                                                    
     echo     ... review function count            - - - - - - - - - - - - -   x_nsource                                                                                             i_equal     0                                                                                                    
     echo     ... review function count            - - - - - - - - - - - - -   x_ntask                                                                                               i_equal     0                                                                                                    
     echo     ... review heartbeat                 - - - - - - - - - - - - -   x_heart                                                                                               w_equal     åæ                                                                                                   

   COND       verify reading header                                              - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((03.007))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     call database read                   metis_db__open              x_name         , 'r'       , &x_nmajor , &x_nminor , &x_nsource, &x_ntask  , x_heart   , &(my.f_db)   i_equal     0                                                                                                    
     echo     ... review file                      - - - - - - - - - - - - -   my.f_db                                                                                               p_exists    0                                                                                                    
     exec     call database close                  metis_db__close             &(my.f_db)                                                                                            i_equal     0                                                                                                    
     echo     ... review file                      - - - - - - - - - - - - -   my.f_db                                                                                               p_null      0                                                                                                    
     echo     ... review project count             - - - - - - - - - - - - -   x_nmajor                                                                                              i_equal     3                                                                                                    
     echo     ... review file count                - - - - - - - - - - - - -   x_nminor                                                                                              i_equal     15                                                                                                   
     echo     ... review function count            - - - - - - - - - - - - -   x_nsource                                                                                             i_equal     5                                                                                                    
     echo     ... review function count            - - - - - - - - - - - - -   x_ntask                                                                                               i_equal     150                                                                                                  
     echo     ... review heartbeat                 - - - - - - - - - - - - -   x_heart                                                                                               w_equal     å17.05.13.06.00.00.6.19.133  1494680400   ¬¬¬¬¬æ                                                     

   REUSE -b-  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   - - - - -   - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  

   COND       complete testing                                                   - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((02.005))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     stop testing                         PROG__unit_end                                                                                                                    i_equal     0                                                                                                    



#23456789-12  123456789-123456789-123456789-12345  123456789-123456789-123456  123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-  123456789-  123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-123456789-  123456789-123456789- 
#==(verb)===  ===========(description)===========  =====(function)===========  ========================(arguments)=================================================================  ==(test)==  ==========================(results)=================================================================  ========(var)======= 
SCRP          (DB) verify reading and writing the database                       2s   data            metis_db_write, metis_db_read                                                ((03.---))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  

   COND       verify program setup                                               - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((03.001))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     setup the program                    PROG__unit_quiet                                                                                                                  i_equal     0                                                                                                    

   REUSE -a-  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   - - - - -   - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  

   COND       setup testing database                                             - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((03.003))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     call name change                     metis_db_cli                "/tmp/lib/metis/metis.db"                                 , '-'                                       i_equal     0                                                                                                    
     get      ... review file                      metis_db__unit              "file"                                                                                                s_equal     DB file          : -  (nil)       -  23å/tmp/lib/metis/metis.dbæ                                     

   REUSE -B-  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   - - - - -   - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  

   COND       verify writing a very simple database                              - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((03.008))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     call database write                  metis_db_write                                                                                                                    i_equal     0                                                                                                    
     get      ... review file                      metis_db__unit              "file"                                                                                                s_equal     DB file          : -  (nil)       y  23å/tmp/lib/metis/metis.dbæ                                     
     get      ... review counts                    metis_db__unit              "count"                                                                                               s_equal     DB count         : C    1j    1n    1s    7t § N    1j    1n    1s    7t § A    0j    0n    0s    0t 

   COND       purge the whole system                                             - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((03.009))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     call full purge                      metis_data_purge_all                                                                                                              i_equal     0                                                                                                    
     exec     ... check count                      metis_major_count                                                                                                                 i_equal     0                                                                                                    
     exec     ... check count                      metis_minor_count                                                                                                                 i_equal     0                                                                                                    
     exec     ... check count                      metis_source_count                                                                                                                i_equal     0                                                                                                    
     exec     ... check count                      metis_task_count                                                                                                                  i_equal     0                                                                                                    

   COND       review all counts                                                  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((03.010))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     get      ... review counts                    metis_db__unit              "count"                                                                                               s_equal     DB count         : C    0j    0n    0s    0t § N    1j    1n    1s    7t § A    0j    0n    0s    0t 

   COND       verify reading simple database                                     - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((03.012))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     call database read                   metis_db_read                                                                                                                     i_equal     0                                                                                                    
     get      ... review file                      metis_db__unit              "file"                                                                                                s_equal     DB file          : -  (nil)       y  23å/tmp/lib/metis/metis.dbæ                                     
     get      ... review counts                    metis_db__unit              "count"                                                                                               s_equal     DB count         : C    1j    1n    1s    7t § N    1j    1n    1s    7t § A    1j    1n    1s    7t 

   COND       check major entries                                                - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((03.013))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     ... check count                      metis_major_count                                                                                                                 i_equal     1                                                                                                    
     exec     ... entry                            metis_major_entry           0                                                                                                     s_equal     0  khronos               1  7å_data.cæ               7å_data.cæ                                      
     exec     ... entry                            metis_major_entry           1                                                                                                     s_equal     n/a                                                                                                  

   COND       check minor entries                                                - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((03.014))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     ... check count                      metis_minor_count                                                                                                                 i_equal     1                                                                                                    
     exec     ... entry                            metis_minor_entry           0                                                                                                     s_equal     0  khronos              _data.c               7 21åtesting a source tasæ 17ålast line in fileæ       
     exec     ... entry                            metis_minor_entry           1                                                                                                     s_equal     n/a                                                                                                  

   COND       check source entries                                               - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((03.015))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     ... check count                      metis_source_count                                                                                                                i_equal     1                                                                                                    
     exec     ... entry                            metis_source_entry          0                                                                                                     s_equal     0  /tmp/metis.unit_testing/prog.c          s  7 21åtesting a source tasæ 17ålast line in fileæ       
     exec     ... entry                            metis_source_entry          1                                                                                                     s_equal     n/a                                                                                                  

   COND       check task entries                                                 - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((03.016))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     ... check count                      metis_task_count                                                                                                                  i_equal     7                                                                                                    
     exec     ... task entry                       metis_task_entry            0                                                                                                     s_equal     0  khronos              _data.c               0 21åtesting a source taskæ     t g 2 # -  y ·  M1GLUb 
     exec     ... task entry                       metis_task_entry            1                                                                                                     s_equal     1  khronos              _data.c               1 15åillegal urgencyæ           ? i 1 >    y ·  M1GLUc 
     exec     ... task entry                       metis_task_entry            2                                                                                                     s_equal     2  khronos              _data.c               2 11åsample taskæ               s a 4 o ³  y ·  M1GLUd 
     exec     ... task entry                       metis_task_entry            3                                                                                                     s_equal     3  khronos              _data.c               3 12åtoo old dateæ              s a 4 o ³  y ·  L1GLUd 
     exec     ... task entry                       metis_task_entry            4                                                                                                     s_equal     4  khronos              _data.c               4 13ålater in fileæ             y c 8 - -  y ·  M1GLUe 
     exec     ... task entry                       metis_task_entry            5                                                                                                     s_equal     5  khronos              _data.c               5 20åfunction level tasksæ      t g 2 - -  y ·  M1GLUg 
     exec     ... task entry                       metis_task_entry            6                                                                                                     s_equal     6  khronos              _data.c               6 17ålast line in fileæ         ! v + - -  y ·  M1GLUf 
     exec     ... task entry                       metis_task_entry            7                                                                                                     s_equal     n/a                                                                                                                                 

   REUSE -C-  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   - - - - -   - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  

   COND       verify writing fuller database                                     - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((03.017))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     call database write                  metis_db_write                                                                                                                    i_equal     0                                                                                                    
     get      ... review file                      metis_db__unit              "file"                                                                                                s_equal     DB file          : -  (nil)       y  23å/tmp/lib/metis/metis.dbæ                                     
     get      ... review counts                    metis_db__unit              "count"                                                                                               s_equal     DB count         : C    1j    3n    3s   12t § N    1j    3n    3s   12t § A    0j    0n    0s    0t 

   COND       purge the whole system                                             - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((03.018))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     call full purge                      metis_data_purge_all                                                                                                              i_equal     0                                                                                                    
     get      ... review counts                    metis_db__unit              "count"                                                                                               s_equal     DB count         : C    0j    0n    0s    0t § N    1j    3n    3s   12t § A    0j    0n    0s    0t 

   COND       verify reading fuller database                                     - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((03.020))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     call database read                   metis_db_read                                                                                                                     i_equal     0                                                                                                    
     get      ... review file                      metis_db__unit              "file"                                                                                                s_equal     DB file          : -  (nil)       y  23å/tmp/lib/metis/metis.dbæ                                     
     get      ... review counts                    metis_db__unit              "count"                                                                                               s_equal     DB count         : C    1j    3n    3s   12t § N    1j    3n    3s   12t § A    1j    3n    3s   12t 

   COND       check major entries                                                - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((03.021))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     ... check count                      metis_major_count                                                                                                                 i_equal     1                                                                                                    
     exec     ... entry                            metis_major_entry           0                                                                                                     s_equal     0  khronos               3  7å_data.cæ               5å.unitæ                                        
     exec     ... entry                            metis_major_entry           1                                                                                                     s_equal     n/a                                                                                                  

   COND       check minor entries                                                - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((03.022))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     ... check count                      metis_minor_count                                                                                                                 i_equal     3                                                                                                    
     exec     ... entry                            metis_minor_entry           0                                                                                                     s_equal     0  khronos              .h                    3 18åfirst header entryæ   17åsomething smalleræ       
     exec     ... entry                            metis_minor_entry           1                                                                                                     s_equal     1  khronos              .unit                 2 20åbut a good unit taskæ 21åand a second good onæ    
     exec     ... entry                            metis_minor_entry           2                                                                                                     s_equal     2  khronos              _data.c               7 21åtesting a source tasæ 17ålast line in fileæ       
     exec     ... entry                            metis_minor_entry           3                                                                                                     s_equal     n/a                                                                                                  

   COND       check source entries                                               - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((03.023))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     ... check count                      metis_source_count                                                                                                                i_equal     3                                                                                                    
     exec     ... entry                            metis_source_entry          0                                                                                                     s_equal     0  /tmp/metis.unit_testing/prog.c          s  7 21åtesting a source tasæ 17ålast line in fileæ       
     exec     ... entry                            metis_source_entry          1                                                                                                     s_equal     1  /tmp/metis.unit_testing/prog.h          t  3 18åfirst header entryæ   17åsomething smalleræ       
     exec     ... entry                            metis_source_entry          2                                                                                                     s_equal     2  /tmp/metis.unit_testing/prog.unit       t  2 20åbut a good unit taskæ 21åand a second good onæ    
     exec     ... entry                            metis_source_entry          3                                                                                                     s_equal     n/a                                                                                                  

   COND       check task entries                                                 - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((03.024))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     ... check count                      metis_task_count                                                                                                                  i_equal     12                                                                                                   
     exec     ... entry                            metis_task_entry            0                                                                                                     s_equal     0  khronos              .h                    0 18åfirst header entryæ        y a 1 o -  y ·  M1GLNc 
     exec     ... entry                            metis_task_entry            1                                                                                                     s_equal     1  khronos              .h                    1 20åanother header entryæ      y n 4 - -  y ·  M1GLMa 
     exec     ... entry                            metis_task_entry            2                                                                                                     s_equal     2  khronos              .h                    2 17åsomething smalleræ         m i q #    y ·  M1GLJf 
     exec     ... entry                            metis_task_entry            3                                                                                                     s_equal     3  khronos              .unit                 0 20åbut a good unit taskæ      w l h - -  y ·  M1GLNe 
     exec     ... entry                            metis_task_entry            4                                                                                                     s_equal     4  khronos              .unit                 1 21åand a second good oneæ     m - 4 #    y ·  M1GLNk 
     exec     ... entry                            metis_task_entry            5                                                                                                     s_equal     5  khronos              _data.c               0 21åtesting a source taskæ     t g 2 # -  y ·  M1GLUb 
     exec     ... entry                            metis_task_entry            6                                                                                                     s_equal     6  khronos              _data.c               1 15åillegal urgencyæ           ? i 1 >    y ·  M1GLUc 
     exec     ... entry                            metis_task_entry            7                                                                                                     s_equal     7  khronos              _data.c               2 11åsample taskæ               s a 4 o ³  y ·  M1GLUd 
     exec     ... task entry                       metis_task_entry            8                                                                                                     s_equal     8  khronos              _data.c               3 12åtoo old dateæ              s a 4 o ³  y ·  L1GLUd 
     exec     ... entry                            metis_task_entry            9                                                                                                     s_equal     9  khronos              _data.c               4 13ålater in fileæ             y c 8 - -  y ·  M1GLUe 
     exec     ... entry                            metis_task_entry            10                                                                                                    s_equal     10 khronos              _data.c               5 20åfunction level tasksæ      t g 2 - -  y ·  M1GLUg 
     exec     ... entry                            metis_task_entry            11                                                                                                    s_equal     11 khronos              _data.c               6 17ålast line in fileæ         ! v + - -  y ·  M1GLUf 
     exec     ... entry                            metis_task_entry            12                                                                                                    s_equal     n/a                                                                                                  
     exec     ... entry                            metis_task_entry            13                                                                                                    s_equal     n/a                                                                                                  

   REUSE -Z-  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   - - - - -   - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  

   REUSE -b-  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   - - - - -   - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  

   COND       complete testing                                                   - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -   ((03.025))  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  
     exec     stop testing                         PROG__unit_end                                                                                                                    i_equal     0                                                                                                    



# end-of-file.  done, finito, completare, whimper [Ï´···
